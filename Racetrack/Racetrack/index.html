<!DOCTYPE html>
<html>
<head>
	<title>Racetrack Game</title>
	<style type="text/css">
		.container {
			background-color: #99CCFF;
			border: thick solid #808080;
			margin: 20px;
			padding: 20px;
		}
	</style>
</head>
<body>
<div class="container">
	<input type="text" id="message"/>
	<input type="button" id="sendmessage" value="Send"/>
	<input type="hidden" id="displayname"/>
	<ul id="discussion"></ul>
</div>
<!--Script references. -->
<!--Reference the jQuery library. -->
<script src="Scripts/jquery-1.6.4.min.js"></script>
<!--Reference the SignalR library. -->
<script src="Scripts/jquery.signalR-2.2.1.min.js"></script>
<!--Reference the autogenerated SignalR hub script. -->
<script src="signalr/hubs"></script>
<!--Add script to update the page and send messages.-->
<script type="text/javascript">
	$(function() {
		var game = $.connection.gameHub;

		game.client.showMap = function (worldModel) {
			var width = worldModel.Width;
			var height = worldModel.Height;
			var map = worldModel.Map;
			console.log(map);
			for (var i = 0; i < height; ++i) {
				$('#discussion').append('<br>');
				for (var j = 0; j < width; ++j) {
					$('#discussion').append(map[i][j] + ' ');
				}
				$('#discussion').append('</br>');
			}
		};

		game.client.showMovements = function(round, name, prevPos, curPos) {
			$('#discussion').append('<li><strong>' + round + ': ' + name +
				'</strong> Moved from (' + prevPos.X + ', ' + prevPos.Y +
				') to (' + curPos.X + ', ' + curPos.Y + ')</li>');
		};
		game.client.beginNextRound = function() {
			document.getElementById('sendmessage').disabled = false;
		};
		$('#message').focus();
		$.connection.hub.start().done(function() {
				$('#sendmessage').click(function() {
						game.server.updatePlayer({
							key: $('#message').val()
						});
						$('#message').val('').focus();
						document.getElementById('sendmessage').disabled = true;
				});
			});
	});
</script>
</body>
</html>